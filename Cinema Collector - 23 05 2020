//первый день разработки того, что будет приложением Cinema Collector для Android
// пока что тестирую код в idea
// научил подключаться к tmdb и выдавать инфу по json а потом парсить в строку
// результат:
// Название фильма - Зеркало
// Дата выхода - 1975-03-07

Process finished with exit code 0


package com.company;

import org.json.JSONException;
import org.json.JSONObject;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;


public class Main {

    public static void main(String[] args) throws IOException {
        connection();
    }

    public static void connection() throws IOException, JSONException {
        String requestUrl = "https://api.themoviedb.org/3/movie/1396?api_key=358d127cfc98138fe9a600b0b63bd94f&language=en-US";
        URL url = new URL(requestUrl);
        HttpURLConnection connection = (HttpURLConnection) url.openConnection();
        connection.connect();
        InputStream in;
        // не знаю, как работает
        int status = connection.getResponseCode();
        if (status != HttpURLConnection.HTTP_OK) {
            in = connection.getErrorStream();
        } else {
            in = connection.getInputStream();
        }

        String response = convertStreamToString(in);

       // получаем текст
        JSONObject obj = new JSONObject(response);
        // дальше идет типа парсер
        String original_title = obj.getString("original_title");
        System.out.println("Название фильма - "+ original_title);
        String release_date = obj.getString("release_date");
        System.out.println("Дата выхода - "+ release_date);


    }

    public static String convertStreamToString(InputStream stream) throws IOException {
        BufferedReader reader = new BufferedReader(new InputStreamReader(stream));
        StringBuilder sb = new StringBuilder();
        String line;
        while ((line = reader.readLine()) != null) {
            sb.append(line).append("\n");
        }
        stream.close();
        return sb.toString();
    }

}



