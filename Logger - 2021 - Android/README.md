
<div align="center"><h1>Logger</h1></div>
<br>
<br>


<p>Логгер, который умеет сохранять логи в базу данных, читать их оттуда и отправлять, методы статические и можно вызывать из нужного участка кода</p>

<p>Пару лет назад писал логер, который сохраняет данные в SharedPreferences, код найти не смог, но появилась мысль написать то же самое для работы с базой данных Room https://developer.android.com/training/data-storage/room.</p>

<p>Для начала создаем класс хранитель данных, назовем его LogExample, в нем будут поля для названия класса, из которого пришло сообщение, названия метода и самого сообщения</p>

<p>Далее приступим к классу, который будет выполнять всю работу - Logger, в нем будет 3 статических метода- saveLog для сохранения сообщения, еще один saveLog, но с передачей в него контекста, для сохранения сообщения и перезапуска программы и sendLog для отправки лога на сервер</p>

<p>В jsonObject.put(“…”, “…”); можно вписывать дополнительные данные, если понадобится, можно добавить еще JSONArray если понадобится</p>

<p>В метод saveLog с передачей контекста добавляем код, который умеет перезапускать приложение, этот код будет вызываться из ExceptionHandler, который срабатывает при падении приложения</p>

<p>Есть много вариантов перезапуска, первоначально я использовал для этого AlarmManager https://developer.android.com/reference/android/app/AlarmManager с отложенным на секунду стартом</p>

<p>Далее делаем класс ExceptionHandler https://developer.android.com/reference/java/lang/Thread.UncaughtExceptionHandler чтобы можно было логировать падения приложения, и вписываем в него saveLog с передачей контекста</p>

<p>Также нужен класс Database, чтобы подключить базу данных, ну там все просто и его можно найти в гугловских мануалах, нет смысла его здесь писать.</p>

<p>Стоит помнить, кто логгер, если вызывается слишком часто, создает дополнительную нагрузку на базу данных, поэтому если она используется в других частях приложения, стандартные настройки Room могут не подойти, подробнее  можно почитать здесь https://developer.android.com/reference/android/arch/persistence/room/DatabaseConfiguration здесь https://developer.android.com/training/data-storage/room также на stackoverflow есть примеры по оптимизации. Также я бы не советовал использовать BaseDao</p>

<p>И последнее, нужна модель для работы с базой данных LogExampleDao</p>